# craft-a-language
极客时间《手把手带你写一门计算机语言》课程代码TypeScript改写Go版本

* [01 实现简洁语言](01/main.go)
  - 目标：让代码理解并解释执行程序
  - 内容：实现了简单的语法分析（生成抽象语法树AST），语义分析（引用消解，关联函数调用和定义）和解释器（深度优先遍历，执行函数调用，当前只执行println函数）。这里为了降低难度没有实现词法分析器，而是直接使用完成词法分析的Token。

* [02 词法分析](02/main.go)
  - 目标：通过词法分析，将程序转换为Token串
  - 内容：实现了词法分析，去除注释和空白符，按照语法规则生成token串；使用预读，而不是尝试解析和回溯

* [03 支持表达式 04 支持变量和类型](04/main.go)
  - 目标：支持表达式和变量
  - 内容：调整了代码组织结构，分为ast、parser、scanner、semantic几个模块。使用运算符优先级算法解析表达式。增加了符号表。增加了左值处理。

* [05 支持函数和返回值](05/main.go)
  - 目标：支持函数和返回值
  - 内容：支持了函数参数、返回值、本地变量。独立出打印对象信息的结构体，如AstDumper。添加了类型体系，这块应该是第04节的内容，但是代码里在05节才实现。增加了作用域表scope。增加了语义分析：类型检查、类型转换、左值等。

* [0809 虚拟机](0809/main.go)
  - 目标：生成字节码并用虚拟机运行
  - 内容：实现了字节码生成器和虚拟机。增加了把字节码写入文件，读取文件还原字节码模块的功能。

* [1011 虚拟机](1011/main.go)
  - 内容：增加了执行时命令行参数。

* [1618 生成汇编](1618/main.go)
  - 内容：生成汇编代码。


## TypeScript改写Go经验
* TS中使用interface Token{}声明数据结构，Go中使用type Token struct{}代替
* TS中的enum，Go中使用const
* TS中的抽象类
  - 只有抽象方法的，Go中使用interface
  - 有抽象方法和属性的，Go中使用接口加实现接口的结构体组合代替
* TS中的构造函数，Go中使用创建函数`NewXXX()`来代替
* TS中的继承 a extends b, Go中使用嵌入组合来代替